<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="/Users/tikkybamiro/Library/Mobile Documents/com~apple~CloudDocs/Documents/Data Analytics Portfolio/Rail Density in EU/RailDens.db" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser pragmas query" current="3"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="100"/><column_width id="3" width="2153"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/></tab_structure><tab_browse><current_table name="4,15:mainAnnualGDPGrowth"/><default_encoding codec=""/><browse_table_settings><table schema="main" name="AnnualGDPGrowth" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort><column index="1" mode="1"/></sort><column_widths><column index="1" value="37"/><column index="2" value="91"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="GDP" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort><column index="5" mode="0"/></sort><column_widths><column index="1" value="88"/><column index="2" value="77"/><column index="3" value="37"/><column index="4" value="42"/><column index="5" value="105"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="GDP (2015$ constant)" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="88"/><column index="2" value="77"/><column index="3" value="37"/><column index="4" value="42"/><column index="5" value="105"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="GDPGrowth" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort><column index="1" mode="0"/></sort><column_widths><column index="1" value="88"/><column index="2" value="37"/><column index="3" value="91"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Land Area" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="88"/><column index="2" value="77"/><column index="3" value="37"/><column index="4" value="42"/><column index="5" value="91"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="LandArea" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="88"/><column index="2" value="77"/><column index="3" value="37"/><column index="4" value="42"/><column index="5" value="91"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Population" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="88"/><column index="2" value="77"/><column index="3" value="37"/><column index="4" value="42"/><column index="5" value="91"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Rail" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="88"/><column index="2" value="77"/><column index="3" value="37"/><column index="4" value="42"/><column index="5" value="66"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Rail lines" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="88"/><column index="2" value="77"/><column index="3" value="37"/><column index="4" value="42"/><column index="5" value="66"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="RailGrowth" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="88"/><column index="2" value="207"/><column index="3" value="268"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="RailPer10000" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="88"/><column index="2" value="115"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="T_GDP" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="88"/><column index="2" value="77"/><column index="3" value="37"/><column index="4" value="42"/><column index="5" value="105"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="V_RAilDensity2021" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="88"/><column index="2" value="73"/><column index="3" value="60"/><column index="4" value="88"/><column index="5" value="173"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="V_RailDensity2021" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="88"/><column index="2" value="73"/><column index="3" value="60"/><column index="4" value="88"/><column index="5" value="173"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table></browse_table_settings></tab_browse><tab_sql><sql name="SQL 4">-- scrap paper
SELECT
	L.CountryName,
	L.LandAreaKmSqr AS Area,
	R.RailLines AS Tracks,
	(L.LandAreaKmSqr/100) AS '100km Squared',
	Round(R.RailLines/(L.LandAreaKmSqr/100),2) AS 'Rail Density Per 100km Squared',
	P.TotalPopulation,
	Round((P.TotalPopulation/100)/R.RailLines) AS '100 People Per km of Track'
FROM
	LandArea L
INNER JOIN
	Rail R
ON
	L.CountryName = R.CountryName AND L.Year = R.Year
INNER JOIN
	Population P
ON 
	R.CountryName = P.CountryName AND P.Year = R.Year
WHERE
	L.Year = 2021
	AND R.RailLines IS NOT NULL
ORDER BY
	&quot;100 People Per km of Track&quot;
	
	
	</sql><sql name="SQL 5">/*
DESCRIPTION: rail density per 100km squared of land area as of 2021 in descending order
*/
CREATE TABLE RailDensity
AS
SELECT
	L.CountryName,
	Round(R.RailLines/(L.LandAreaKmSqr/100),1) AS 'Rail Density Per 100km Squared'
FROM
	LandArea L
INNER JOIN
	Rail R
ON
	L.CountryName = R.CountryName AND L.Year = R.Year
WHERE
	R.Year = 2021
	AND
	R.RailLines IS NOT NULL
ORDER BY
	&quot;Rail Density Per 100km Squared&quot; DESC
	
	
	</sql><sql name="SQL 6">/*
annual GDP growth rate by country
*/
CREATE TABLE GDPGrowth
AS
WITH
	GDP_CTE
AS (
		SELECT 
			CountryName,
			Year,
			GDP,
			CAST (LAG(GDP) OVER (PARTITION BY CountryName ORDER BY Year) AS REAL) AS PreviousYearGDP
		FROM
			T_GDP
)
SELECT
	CountryName,
	Year,
	CAST (round(((GDP_CTE.GDP - PreviousYearGDP)/PreviousYearGDP)*100,2) AS REAL) AS GDPGrowthRate
FROM
	GDP_CTE
WHERE
	PreviousYearGDP IS NOT NULL
ORDER BY
&quot;Year&quot; DESC




</sql><sql name="SQL 8">/*
average annual GDP growth rate across all countries
*/
CREATE TABLE AnnualGDPGrowth
AS
WITH
	GDP_CTE
AS (
		SELECT 
			Year,
			GDP,
			LAG(GDP) OVER (PARTITION BY CountryName ORDER BY Year) AS PreviousYearGDP
		FROM
			T_GDP
)
SELECT
	Year,
	round(avg(((GDP_CTE.GDP - PreviousYearGDP)/PreviousYearGDP)*100),2) AS GDPGrowthRate
FROM
	GDP_CTE
WHERE
	PreviousYearGDP IS NOT NULL
GROUP BY
	&quot;Year&quot;
ORDER BY
&quot;YEAR&quot; DESC

</sql><sql name="SQL 11">/*
DESCRIPTION: rail per capita for each country as of 2021 (excluding Estonia due to lack of rail data)
*/
CREATE TABLE RailPer10000
AS
SELECT
	Rail.CountryName,
	round(RailLines/(CAST (TotalPopulation AS REAL)/10000),2) AS &quot;Rail Per 1000 People&quot;
FROM
	Rail
JOIN
	Population
ON
 Population.CountryName = Rail.CountryName AND Population.Year = Rail.Year
WHERE
	Population.Year = 2021 AND RailLines IS NOT NULL
ORDER BY
&quot;Rail Per 1000 People&quot; DESC</sql><sql name="SQL 12">/*
Change in rail lines from 1995 to 2021 by CountryCode
*/
CREATE TABLE RailGrowth
AS
WITH Rail_CTE AS
	(SELECT
		CountryName,
		Year,
		CAST (RailLines AS REAL),
		(CAST (RailLines AS REAL) - lag(CAST (RailLines AS REAL)) OVER (PARTITION BY CountryName ORDER BY Year)) AS &quot;Change&quot;,
		(CAST (RailLines AS REAL) - lag(CAST (RailLines AS REAL)) OVER (PARTITION BY CountryName ORDER BY Year))/lag(CAST (RailLines AS REAL)) OVER (PARTITION BY CountryName ORDER BY Year)*100 AS PercentageChange
	FROM
	Rail
	WHERE
	Year = 2021 OR Year = 1995
	)
SELECT
	CountryName,
	Round(Change,3) AS &quot;Change in km of rail from 1995 to 2021&quot;,
	Round(PercentageChange,3) AS &quot;Percentage change in km of rail from 1995 to 2021&quot;
FROM
	Rail_CTE
WHERE
	Change IS NOT NULL
ORDER BY
	PercentageChange DESC


</sql><current_tab id="5"/></tab_sql></sqlb_project>
